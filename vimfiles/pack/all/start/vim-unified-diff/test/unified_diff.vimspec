Describe vim-unified-diff
  Context unified_diff#parse({unified})
    It should return a normal diff
      let unified = [
            \ '--- sample.c.orig	2015-03-26 02:22:29.343996331 +0900',
            \ '+++ sample.c	2015-03-26 02:23:24.735243780 +0900',
            \ '@@ -3,2 +3 @@',
            \ '-// Frobs foo heartily',
            \ '-int frobnitz(int foo)',
            \ '+int fib(int n)',
            \ '@@ -6,2 +5 @@',
            \ '-    int i;',
            \ '-    for(i = 0; i < 10; i++)',
            \ '+    if(n > 2)',
            \ '@@ -9,2 +7 @@',
            \ '-        printf("Your answer is: ");',
            \ '-        printf("%d\n", foo);',
            \ '+        return fib(n-1) + fib(n-2)',
            \ '@@ -11,0 +9 @@',
            \ '+    return 1;',
            \ '@@ -14 +12,2 @@',
            \ '-int fact(int n)',
            \ '+// Frobs foo heartily',
            \ '+int frobnitz(int foo)',
            \ '@@ -16 +15,2 @@',
            \ '-    if(n > 1)',
            \ '+    int i;',
            \ '+    for(i = 0; i < 10; i++)',
            \ '@@ -18 +18 @@',
            \ '-        return fact(n-1) * n;',
            \ '+        printf("%d\n", foo);',
            \ '@@ -20 +19,0 @@',
            \ '-    return 1;',
            \ '@@ -25 +24 @@',
            \ '-    frobnitz(fact(10));',
            \ '+    frobnitz(fib(10));',
            \]
      let result = unified_diff#parse(unified)
      let expect = [
            \ '3,4c3',
            \ '< // Frobs foo heartily',
            \ '< int frobnitz(int foo)',
            \ '---',
            \ '> int fib(int n)',
            \ '6,7c5',
            \ '<     int i;',
            \ '<     for(i = 0; i < 10; i++)',
            \ '---',
            \ '>     if(n > 2)',
            \ '9,10c7',
            \ '<         printf("Your answer is: ");',
            \ '<         printf("%d\n", foo);',
            \ '---',
            \ '>         return fib(n-1) + fib(n-2)',
            \ '11a9',
            \ '>     return 1;',
            \ '14c12,13',
            \ '< int fact(int n)',
            \ '---',
            \ '> // Frobs foo heartily',
            \ '> int frobnitz(int foo)',
            \ '16c15,16',
            \ '<     if(n > 1)',
            \ '---',
            \ '>     int i;',
            \ '>     for(i = 0; i < 10; i++)',
            \ '18c18',
            \ '<         return fact(n-1) * n;',
            \ '---',
            \ '>         printf("%d\n", foo);',
            \ '20d19',
            \ '<     return 1;',
            \ '25c24',
            \ '<     frobnitz(fact(10));',
            \ '---',
            \ '>     frobnitz(fib(10));',
            \]
      Assert Equals(result, expect)
    End
  End
End
